"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[292],{4570:function(t,e,s){s.d(e,{Z:function(){return l}});var o=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{"margin-bottom":"20px","font-size":"22px","font-weight":"bold"}},[t._v("评论 "+t._s(t.commentCount))]),e("div",{staticStyle:{"margin-bottom":"20px"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入评论"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(null)}}},[t._v("评论")])],1)],1),e("div",[t._l(t.commentList,(function(s){return e("div",{key:s.id,staticStyle:{"margin-bottom":"20px"}},[e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:s.avatar,alt:""}}),e("div",{staticStyle:{"padding-left":"15px",flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px",color:"#666"}},[t._v(t._s(s.userName))]),e("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(s.content))]),e("div",{staticStyle:{color:"#666","font-size":"13px","margin-bottom":"5px"}},[e("span",[t._v(t._s(s.time))]),e("span",{class:{"comment-active":s.showReply},staticStyle:{margin:"0 20px",cursor:"pointer"},on:{click:function(e){return t.handleShowReply(s)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("回复")]),s.userId===t.user.id?e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delComment(s.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),s.showReply?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复"},model:{value:s.replyContent,callback:function(e){t.$set(s,"replyContent",e)},expression:"item.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(s)}}},[t._v("回复")])],1)],1):t._e()])]),s.children?e("div",{staticStyle:{"padding-left":"65px"}},t._l(s.children,(function(o){return e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:o.avatar,alt:""}}),e("div",{staticStyle:{"padding-left":"15px",flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px",color:"#666"}},[t._v(t._s(o.userName)+" "),o.parentUserName!==s.userName?e("span",[t._v("回复："+t._s(o.parentUserName))]):t._e()]),e("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(o.content))]),e("div",{staticStyle:{color:"#666","font-size":"13px","margin-bottom":"5px"}},[e("span",[t._v(t._s(o.time))]),e("span",{class:{"comment-active":o.showReply},staticStyle:{margin:"0 20px",cursor:"pointer"},on:{click:function(e){return t.handleShowReply(o)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("回复")]),o.userId===t.user.id?e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delComment(o.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),o.showReply?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复"},model:{value:o.replyContent,callback:function(e){t.$set(o,"replyContent",e)},expression:"sub.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(o)}}},[t._v("回复")])],1)],1):t._e()])])})),0):t._e()])})),t.total>0?e("div",{staticStyle:{"margin-top":"10px"}},[e("el-pagination",{attrs:{small:"",background:"","current-page":t.pageNum,"page-sizes":[5,10,20],"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],2)])},i=[],a={name:"CommentComponent",props:{fid:null,module:null},data(){return{user:JSON.parse(localStorage.getItem("xm-user")||"{}"),commentCount:0,content:"",commentList:[],pageNum:1,pageSize:5,total:0}},created(){this.loadComment()},methods:{handleShowReply(t){this.$set(t,"showReply",!t.showReply)},delComment(t){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/comment/delete/"+t).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.loadComment()):this.$message.error(t.msg)}))})).catch((()=>{}))},loadComment(){this.$request.get("/comment/selectTree/"+this.fid+"/"+this.module,{params:{pageNum:this.pageNum,pageSize:this.pageSize}}).then((t=>{this.commentList=t.data?.list||[],this.total=t.data?.total||0})),this.$request.get("/comment/selectCount/"+this.fid+"/"+this.module).then((t=>{this.commentCount=t.data||0}))},addComment(t){let e={fid:this.fid,userId:this.user.id,module:this.module,content:this.content};t&&(e.content=t.replyContent,e.pid=t.id),e.content?this.$request.post("/comment/add",e).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.content="",this.loadComment()):this.$message.error(t.msg)})):this.$message.warning("请输入内容!")},handleCurrentChange(t){this.pageNum=t,this.loadComment()}}},n=a,r=s(1001),d=(0,r.Z)(n,o,i,!1,null,"0d6bc018",null),l=d.exports},7292:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{margin:"0 auto",padding:"10px 0",width:"50%"}},[e("div",{staticStyle:{display:"flex","grid-gap":"20px","margin-bottom":"40px"}},[e("img",{staticStyle:{width:"50%",height:"400px",display:"block"},attrs:{src:t.goods.img,alt:""}}),e("div",{staticStyle:{flex:"1",width:"0"}},[e("el-tooltip",{attrs:{content:t.goods.name,placement:"top-start"}},[e("div",{staticClass:"line1",staticStyle:{width:"100%","font-weight":"bold","font-size":"26px",margin:"20px 0"}},[t._v(t._s(t.goods.name))])]),e("div",{staticStyle:{color:"#666","font-size":"16px"}},[e("span",[t._v("浏览 "+t._s(t.goods.readCount))]),e("span",{staticStyle:{"margin-left":"20px"}},[t._v("点赞 "+t._s(t.goods.likesCount))]),e("span",{staticStyle:{"margin-left":"20px"}},[t._v("收藏 "+t._s(t.goods.collectCount))])]),e("div",{staticStyle:{color:"red","font-size":"24px",margin:"40px 0"}},[t._v("￥"+t._s(t.goods.price))]),e("div",{staticStyle:{"margin-bottom":"20px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("发货地：")]),t._v(" "+t._s(t.goods.address))]),e("div",{staticStyle:{"margin-bottom":"20px"}},[e("span",{staticStyle:{color:"#666"}},[t._v(" 卖家：")]),t._v(" "+t._s(t.goods.userName)+" "),e("el-tooltip",{attrs:{effect:"light",content:"聊天",placement:"right","hide-after":2e3}},[e("i",{staticClass:"el-icon-chat-dot-round",staticStyle:{"font-size":"18px","margin-left":"3px",cursor:"pointer"},on:{click:function(e){return t.chat(t.goods.userId)}}})])],1),e("div",{staticStyle:{"margin-bottom":"40px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("发布日期：")]),t._v(" "+t._s(t.goods.date))]),e("div",[t.goods.userLikes?t._e():e("el-button",{staticStyle:{"background-color":"orangered",color:"#eee","border-color":"orangered"},attrs:{size:"medium"},on:{click:t.addLikes}},[t._v("点赞")]),t.goods.userLikes?e("el-button",{staticStyle:{"background-color":"orangered",color:"#eee","border-color":"orangered"},attrs:{size:"medium"},on:{click:t.addLikes}},[t._v("已点赞")]):t._e(),t.goods.userCollect?t._e():e("el-button",{attrs:{size:"medium",type:"warning"},on:{click:t.addCollect}},[t._v("收藏")]),t.goods.userCollect?e("el-button",{attrs:{size:"medium",type:"warning"},on:{click:t.addCollect}},[t._v("已收藏")]):t._e(),e("el-button",{attrs:{size:"medium",type:"danger"},on:{click:t.handleBuy}},[t._v("立即购买")])],1)],1)]),e("div",[e("div",{staticStyle:{display:"flex","border-bottom":"1px solid orangered","margin-bottom":"10px"}},[e("div",{class:{active:"商品详情"===t.current},staticStyle:{padding:"10px 20px",cursor:"pointer"},on:{click:function(e){return t.changeItem("商品详情")}}},[t._v("商品详情")]),e("div",{class:{active:"商品评论"===t.current},staticStyle:{padding:"10px 20px",cursor:"pointer"},on:{click:function(e){return t.changeItem("商品评论")}}},[t._v("商品评论")])]),"商品详情"===t.current?e("div",[e("div",{domProps:{innerHTML:t._s(t.goods.content)}})]):t._e(),"商品评论"===t.current?e("div",{staticClass:"card"},[e("Comment",{attrs:{fid:t.id,module:"goods"}})],1):t._e(),e("el-dialog",{attrs:{title:"选择收货地址",visible:t.fromVisible,width:"30%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(e){t.fromVisible=e}}},[e("div",{staticStyle:{padding:"0 20px"}},[e("el-radio-group",{model:{value:t.form.addressId,callback:function(e){t.$set(t.form,"addressId",e)},expression:"form.addressId"}},t._l(t.addressList,(function(s){return e("el-radio",{key:s.id,staticStyle:{"margin-bottom":"10px"},attrs:{label:s.id}},[t._v(" "+t._s(s.name+" "+s.address+" "+s.phone)+" ")])})),1),0===t.addressList.length?e("a",{attrs:{href:"/front/address",target:"_blank"}},[t._v("还没有收货地址？去创建")]):t._e()],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.fromVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.addOrder}},[t._v("确 定")])],1)])],1)])},i=[],a=(s(7658),s(4570)),n={name:"GoodsDetail",components:{Comment:a.Z},data(){return{id:this.$route.query.id,user:JSON.parse(localStorage.getItem("xm-user")||"{}"),goods:{},current:"商品详情",form:{},fromVisible:!1,addressList:[]}},created(){this.$request.put("/goods/updateReadCount/"+this.id).then((t=>{this.load()})),this.loadAddress()},methods:{chat(t){this.$request.post("/chatGroup/add",{chatUserId:t,userId:this.user.id}).then((t=>{this.$router.push("/front/chat")}))},addOrder(){this.form.addressId?(this.form.goodsId=this.id,this.$request.post("/orders/add",this.form).then((t=>{"200"===t.code?(this.$message.success("下单成功"),this.$router.push("/front/orders")):this.$message.error(t.msg)}))):this.$message.warning("请选择收货地址")},loadAddress(){this.$request.get("/address/selectAll").then((t=>{this.addressList=t.data||[]}))},handleBuy(){this.form={},this.fromVisible=!0},addCollect(){this.$request.post("/collect/add",{fid:this.goods.id,module:"goods"}).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.load()):this.$message.error(t.msg)}))},addLikes(){this.$request.post("/likes/add",{fid:this.goods.id,module:"goods"}).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.load()):this.$message.error(t.msg)}))},changeItem(t){this.current=t},load(){this.$request.get("/goods/selectById/"+this.id).then((t=>{this.goods=t.data||{}}))}}},r=n,d=s(1001),l=(0,d.Z)(r,o,i,!1,null,"0e2d98ca",null),c=l.exports}}]);
//# sourceMappingURL=292.a03e117e.js.map